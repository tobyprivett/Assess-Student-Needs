%h1.page-header Lesson: #{ @lesson.name }

%dl.dl-horizontal
  %dt Group
  %dd= link_to @lesson.group.name, group_path(@lesson.group)

  %dt Date
  %dd= @lesson.lesson_datetime || '&nbsp;'.html_safe

  %dt Objective
  %dd= @lesson.name


%dl.dl-horizontal
  %dt Level
  %dd.level #{ @lesson.indicator.level }

  %dt Strand
  %dd.strand #{ @lesson.indicator.strand_name }

  %dt Indicator
  %dd.indicator_name #{ @lesson.indicator.name }

  - if description = @lesson.indicator.description
    %dt Description
    %dd.muted.description #{ description.gsub("_ ", "<br/>").html_safe }

= link_to "Scoring View", group_lesson_path(@group, @lesson)
|
= link_to "Report View", group_lesson_path(@group, @lesson, mode: 'report')
|
= link_to "Edit Lesson Details & Students ", edit_group_lesson_path(@group, @lesson)


%p

- if params[:mode] == 'report'
  %table.table
    %tbody
      %tr
        %th Student
        %th Ticks
        %th Score
        %th Note
      - @lesson_students.sort_by(&:ticks).each do |lesson_student|
        - ticks = "ticks_#{ lesson_student.ticks }"
        %tr
          %td{ class: ticks }= link_to lesson_student.student.name, student_path(lesson_student.student)
          %td{ class: ticks }= lesson_student.ticks
          %td{ class: ticks }= lesson_student.score
          %td{ class: ticks }= lesson_student.notes
- else
  %table.table
    %tbody
      %tr
        %th Student
        %th Notes / Score
        %th
        %th Accomplishment
      - @lesson_students.sort{|ls| ls.student.name <=> ls.student.name }.each do |lesson_student|
        = render :partial => 'student', locals: { lesson_student: lesson_student }