.panel.panel-default
  .panel-heading
    .panel-title
      = @lesson.new_record? ? 'Add a new lesson' : 'Edit lesson'
  .panel-body
    = bootstrap_nested_form_for [@group, @lesson], layout: 'horizontal' do |f|
      = f.text_field :name, label: 'Goal'
      = f.date_field :lesson_date, label: 'Date'
      = f.fields_for :objectives do |objective_f|
        .well.objective
          = objective_f.text_field :name, class: 'objective-name'
          = objective_f.select :indicator_id,
            Indicators::Objective.includes(:self_and_ancestors).map{ |t| [t.delimited_ancestry_names, t.id]},
            label: "Objective (#{ objective_f.link_to_remove('Remove') })".html_safe

      %p= f.link_to_add 'Add an objective', :objectives
      = f.submit 'Save'
